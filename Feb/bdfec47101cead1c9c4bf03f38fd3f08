About 30,000 people packed a stadium in Kenya's capital, Nairobi, for the state funeral of the country's longest-serving President Daniel arap Moi, who died last week aged 95. Rather than mourning, many in the crowd celebrated Mr Moi's life. He was a towering figure who dominated Kenyan politics during his 24-year presidency. Critics saw him as an authoritarian ruler, while allies credited him for maintaining stability. Mr Moi cracked down on the opposition following a failed coup in 1982. Before he left office in 2002, he asked for forgiveness from "those he had wronged". Mourners gathered at the Nyayo National Stadium from before dawn to pay their respects, some of them wearing traditional regalia. Mr Moi's cortege arrived in the stadium flanked by long lines of red-coated soldiers and a brass band playing marching tunes and Christian hymns. President Uhuru Kenyatta called Mr Moi "a father of our nation, a champion of Pan-Africanism". Mr Moi's son, Gideon Moi, remembered him as "a man with an elephantine memory and a compassionate heart". "He also loved meat, and nothing could come between him and meat even when the doctors warned him," Gideon Moi said. Mr Moi was a stickler for order - so he would have loved his state funeral where he was accorded full military honours. His casket was draped in the flag of Kenya and was drawn on a gun carriage, in a tradition borrowed from the British. Sharply dressed senior officers of the military marched across Nairobi, led by a colourful band. Leaders from across the continent and beyond attended the funeral. Mr Moi played a significant role in the region. When war broke out in neighbouring states - especially Somalia, Sudan and Uganda - he opened Kenya's doors to refugees and led peace negotiations. Mr Moi has been praised for keeping peace at home in a region rocked by instability. Many of the tens of thousands of mourners at the stadium remembered Mr Moi with nostalgia. They sang along to songs from the past praising him. They remembered his enduring legacy in education - his dedication to building schools and universities across the country and the distribution of free milk to attract children from poor regions to school. But there are those who criticise him for the brutal crackdown on dissent. His fiercest critics were detained, often without trial, and tortured. Some of them have now mellowed. They joined mourners in honouring the late leader. Those who have not paid tribute have been quiet - perhaps fearing a backlash in a country where talking ill of the dead is frowned upon. Kenya's main opposition leader Raila Odinga, who was charged with treason and detained without trial for six years during Mr Moi's rule, said the ex-president had "weaknesses". Nevertheless, Mr Moi was an "independence hero" and the two of them had made peace, Mr Odinga said. The funeral comes after Mr Moi's body lay in state for three days at the parliamentary buildings. Tens of thousands of people had queued to see his body. He will be buried on Wednesday at his home in Kabarak, 220km (130 miles) north-west of Nairobi. He died on 4 February at a private hospital in Nairobi of an undisclosed illness.